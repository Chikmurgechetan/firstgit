<body>
    <h1>Appointent App</h1><hr>
    <form onsubmit="saveToLocalStorage(event)">
      <label>Name</label> <br>
      <input type="text" id="name" name="name" required/><br>
      <label>Email Id</label><br>
      <input type="email"  id="email" name="email" required/><br>
      <label>Pho No</label><br>
      <input type="phonenumber" id="phonenumber" name="phonenumber"/><br>
      <button>Submit</button>
      </form>
      <ul id="listOfUsers"></ul>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.4.1/axios.min.js"></script>
      <script>
        function saveToLocalStorage(event){
          event.preventDefault();
          const name=event.target.name.value;
          const email=event.target.email.value;
          const phonenumber=event.target.phonenumber.value;
          //localStorage.setItem('name',name);
          //localStorage.setItem('email',email);
          //localStorage.setItem('phonenumber',phonenumber);
          const obj = {
            name: name,
            email: email,
            phonenumber: phonenumber         
          }
          axios.post("https://crudcrud.com/api/9204d58c5f6f49f4bd4f8e8a8e9bbd81/userDetails",obj)
           .then((response)=>{
            showNewUserOnScreen(response.data)
            console.log(response)
           })
           .catch((error)=>{
            console.log(error)
           })
          //localStorage.setItem(obj.name,JSON.stringify(obj));
          //showNewUserOnScreen(obj);
        }
        window.addEventListener('DOMContentLoaded', () => {
  
  
  
          const localStorageObj = localStorage;
          const localStoragekeys = Object.keys(localStorageObj)
  
          for(var i=0; i<localStoragekeys.length;i++){
            const key = localStoragekeys[i]
            const usrDetailsString = localStorageObj[key];
            const userDetailsObj = JSON.parse(usrDetailsString);
            showNewUserOnScreen(userDetailsObj)
          }
        })
        function showNewUserOnScreen(user){
  
          const parentNode = document.getElementById('listOfUsers');
          const childHTML = `<li id=${user.name}> ${user.name}-${user.email}
                          <button onclick=deleteUser('${user.name}')> Delete User </button> 
                          <button onclick=editUserDetails('${user.name}','${user.email}','${user.phonenumber}')>Edit User</button>
                          </li>`
  
          parentNode.innerHTML=parentNode.innerHTML + childHTML;
        } 
         function editUserDetails(name,email,phonenumber){
          document.getElementById('name').value = name;
          document.getElementById('email').value = email;
          document.getElementById('phonenumber').value = phonenumber;
  
          deleteUser(name);
         }     
  
        function deleteUser(name){
          console.log(name);
          localStorage.removeItem(name);
          removeUserFromScreen(name);
        }
        function removeUserFromScreen(name){
          const parentNode = document.getElementById('listOfUsers');
          const childNodeToBeDeleted = document.getElementById(name);
  
          parentNode.removeChild(childNodeToBeDeleted)
        }
  
  
  
      </script>
  </body>
  </html>